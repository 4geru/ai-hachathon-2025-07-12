# Sky Canvas - 技術スタック: Three.js

## 1. 概要

Three.jsは、Webブラウザ上で3Dグラフィックスを描画するためのJavaScriptライブラリです。WebGLを抽象化し、3Dシーンの構築、オブジェクトの配置、ライト、カメラ、アニメーションなどの複雑な処理を容易にします。本プロジェクト「Sky Canvas」では、ディスプレイアプリにおける花火の鮮やかなビジュアル生成に利用されます。

## 2. 採用理由

-   **WebGLの抽象化:** WebGLの低レベルなAPIを直接扱うことなく、手軽に高性能な3Dグラフィックスを実現できます。
-   **豊富な機能:** パーティクルシステム、シェーダー、物理ベースレンダリングなど、花火の多様な表現に必要な機能が揃っています。
-   **パフォーマンス:** GPUアクセラレーションを活用することで、複雑な花火の描画でも高いフレームレートを維持できます。
-   **コミュニティとドキュメント:** 活発なコミュニティと充実したドキュメントがあり、開発中に問題が発生した場合の解決策を見つけやすいです。

## 3. プロジェクトにおける役割

### 3.1. ディスプレイアプリ

-   **花火のビジュアル生成:** Supabaseから受信した花火イベントデータ（色、サイズ、パターン、AIシードなど）に基づき、リアルタイムで3D花火を生成・描画します。
-   **パーティクルシステム:** 花火の爆発や光の拡散を、大量のパーティクル（粒子の集まり）を用いて表現します。これにより、リアルで幻想的な花火の動きを再現します。
-   **物理シミュレーション:** 花火の打ち上げから爆発、そして消滅までの軌道、重力、空気抵抗といった物理的な挙動をThree.js内でシミュレートし、自然な動きを実現します。
-   **アニメーション:** 花火の色や形状の変化、光の強さの減衰など、時間経過による動的な演出を制御します。

## 4. 関連する設計判断

-   **パフォーマンス最適化:**
    -   **GPUインスタンシング:** 大量のパーティクルを効率的に描画するために、GPUインスタンシングを活用します。
    -   **シェーダーの最適化:** カスタムシェーダーを用いて、花火の光彩や残像、煙といった視覚効果を効率的かつ美しく表現します。
    -   **メモリ管理:** オブジェクトプーリングなどを利用し、頻繁に生成・破棄されるパーティクルのメモリフットプリントを最小限に抑えます。
-   **Web Audio APIとの連携:** 花火のビジュアルアニメーションとWeb Audio APIによるサウンド生成を密接に同期させ、多感覚的な体験を提供します。 